# 리팩터링 로그

## 시작

- 설치할때 문제 발생. 디펜던시 트리가 제대로 구성이 안되서 설치한 후에도 실행이 안됨. 아 잘안되어서 얀을쓴거야? ㅋㅋㅋ
- 얀 설치 후 실행 성공.

- 아무래도 nvm으로 node 버전을 좀 고정해야겠지? .nvmrc 만들어서 nodejs 최신lts 버전 입력함
- nvm install, nvm use로 환경 설정함
- README에 nodejs 환경설정 방법 기록

## ux

- 앱 실행했는데 ux가 개판인데요?
- 문제점들

  - notes & archived 탭 스타일이 왜 딱 붙어있지? 이러면 탭이라고 인지를 못하죠
  - 카드 박스 내부에 Delete라는 텍스트는 왜 있는거에요? 클릭한다고 그 Delete가 동작하는것도 아니고;; 이상하네 대체 용도가 뭐지
  - Create 눌렀을때 모달의 넓이가 화면을 가득채워서 너무 보기가 힘들어요. 최대 넗이 지정이 필요하겠군요
  - 모달 바깥 영역을 클릭해도 닫히지 않아요. esc도 안먹어요.
  - 새로 만든 노트를 다시 클릭해서 수정하고 save버튼을 눌렀을때 새로고침이 되어버려서 새로 만든 노트들이 싹 사라져버려요;;
  - 노트 클릭해서 나타나는 모달의 `...` 클릭해도 form submit이 되어버려서 새로고침이 되어버려요.

- 애초에 https://note-taking-vanilla.alexkwon.io/ 이걸 클론하는거니까 여기의 기능을 충실히 따라야하는데 그러지 못하고 있는 상태같아요. 최대한 저기에 맞추는 방향으로 리팩터링 해볼게요
- 스토리북은 제대로 보여지는 스토리도 없는 관계로 보고싶지도 않네요!

- 자 일단.. 뭐가 문제인지들은 좀 알았고 일단 코드 구조나 좀 살펴봅시다

## 코드 분석

### 일반

- 컴포넌트 이름이랑 디렉토리랑 이름이 다르다.
- 일반적으로 죄다 index로 하는것보다 파일 이름을 파스칼 케이스로 컴포넌트 파일이름을 짓지
- 안쓰는 코드 주석은 삭제해야져~
- 안쓰는 컴포넌트도 삭제해야져 (card)
- 타입정의를 데클러레이션으로 하는 것 대신 파일에 명시적으로 적어주는게 더 좋을꺼에요. 큰 프로젝트라면 이름 겹쳐서 쉽지 않을겁니다!

### button

- 컴포넌트 파일 하나에 외부에서 사용할 수 있는 복수개의 컴포넌트가 있음. 이런 경우에는 컴포넌트 파일 여러개로 분리해야함.

### card-item

- toggleNote를 사용하지도 않을꺼면 props에 대체 왜 있는걸까요? 안쓰면 지워야죠. 이거때문에 쓸데없이 card-list에도 toggleNote를 만들어 버렸네요
- handleRemove는 콘솔만 찍을꺼면 왜 있는거져? 그리고 onClick 핸들러니까 handleClick이라고 이름짓는게 일반적이에요
- card-item은 카드 박스만을 표현하는 ui 컴포넌트라서 모달 상태를 관리하면 안될꺼 같아요. 모달이란 ui는 글로벌하게 나타나는 ui잖아요? 따라서 그 상태관리도 가장 글로벌한 곳에 있는게 좋을꺼에요. 여기서는 pages/index가 적합해보이네요

### card-list

- 이 컴포넌트가 굳이 필요할지 모르겠어요. 단순히 map으로 리스트 뿌려주기만하는거라서요.
- 뭐 그냥 추상화해서 필요하다고 쳐봅시다. 그러면 toggleList는 쓰지도 않는데! 없애던지! 아 근데 저 왜 이렇게 된지 알꺼 같아요. 모달을 밖으로 뺀다음에 이 함수를 통해서 뭐 클릭했는지 감지해서 알맞은 모달을 열어주고 싶었죠? 근데 그게 잘 안되어서 모달을 card-item에 집어넣게 되었나봐요. 근데 이 코드는 지우지 못한거려나~~
- 이 컴포넌트 살리고, 모달을 글로벌리 사용했을때 어떻게 이벤트 처리 할 수 있는지 리팩터링하면서 보여드리꼐여

### create-note-modal

- 파일 이름이랑 컴포넌트이름이랑 일치하지 못해여. 반드시 일치시켜야해요
- form요소를 썼다면 button의 onClick에서 로직을 처리하는것보다 form의 submit 이벤트에서 처리하는게 더 네이티브한 방법이에요. onSubmit에서 로직 처리해야함니다
- SecondayButton은 타입 에러가 나고있네요
- 이 모달에서 setShow는 필요가 없어요. 왜냐면 모달내부에서는 자기 스스로를 닫는 행동밖에 없잖아요. onClose 같은 props로 무조건 닫기밖에 없는 함수를 받는게 맞아요. 컴포넌트의 props는 왠만하면 기능을 제한하는 방향으로 인터페이스를 열어줘야해요. 그래야 컴포넌트의 오용이 없어요. 뭔가 필요해진다? 그럼 그때가서 열어주면 되여.
- props에 note는 쓰지도 않는데 왜받고있는거져. 삭제 ㄱ
- 아니 이미 closeNote라는 props가 있군요. 근데 이벤트 핸들러니까 on\* 프리픽스가 있어야해요. 근데 쓰지도 않는데 왜받는거야;;
- addNote는 그나마 말이되네요. 대신 onAdd라는 이름으로 바꾸는게 좋을것 같아요. 양식 제출 버튼이 Create니까요

### manage-note

- 이거 모달이면 create-note-modal마냥 모달이라는 이름이 붙어야 할꺼 같은데요? 일관성있는 네이밍 습관이 필요해요
- 아직 이거 구현이 안된것 같은데요?

### types.d.ts

- Note 인터페이스에는 completed라는 필드는 왜 있을까요? 클론대상에는 완료된 노트? 그런 개념이 없는데요? 아니 애초에 완료된 노트라는게 있나요? 그건 투두겠져~

### pages/index

- toggleNote는 쓰지도 않는 로직인데 지워야겠죠?

## 리팩터링

- ㅇㅋ 대충 문제점들 파악했구여 스토리북 기반으로 일단 컴포넌트부터 제대로 다시 설계할께요. 컴포넌트에는 반드시 스토리북이 있어야해요 그렇지 않으면 제대로된 테스팅이 어려워요.
- 일단은 사용처에서 타입깨지는거 그냥 감수하고 스토리북으로만 밀고나갈게요
- 컴포넌트 & 스토리북 템플릿 README에 올려놓음. 원래는 에디터에 자동화도 할 수 있는데 일단 귀찮아서 걍 복붙으로 고고

### button들

- 자주 사용하는 버튼부터 시작해봅시다
- 버튼의 종류가 여러가지고 각각 종류별로 컴포넌트 파일을 만들꺼에요
- primary 버튼 만듬
- primary 버튼 크기 스타일 변경. 14px (sm)
- secondary button 만듬
- secondary button 텍스트 스타일 변경 . 14px
- onClick들은 안쓸때도 있으니까 옵셔널로 변경

### card-item

- 일단 파일 네이밍 컨벤션부터 손보고 스토리북 만들어놓자
- props 인터페이스를 CardItemProps로 변경.
- 스토리북에 note를 안넘겨서 깨지지? 일단 Note 인터페이스좀 다시 정의해보자. 정의는 types.d.ts말고 그냥 CardItem에 일단 해도 될듯
- types.d.ts에서 노트 삭제후 CardItem에 옮기기. 인터페이스로 바꾸자
- Note 타입에선 complete가 없어도 될꺼 같애.쓰지도 필요도 없으니까
- 기획에 맞게 수정. 딜리트버튼 이런거 노필요
- 스토리북에 note 데이터 넘겨보기
- 생각해보니까 note라고 넘길 필요가 없어보여.. 그냥 title, content만 넘기면 되는거 아니야? ㅇㅇ 이렇게 수정
- ManageNote는 삭제. 여기서 관리안할꺼임
- 클릭핸들러 onClick 넣자
- 스토리북에 title, content 넘기기

### card-list
